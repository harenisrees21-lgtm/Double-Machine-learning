**Title: Advanced Causal Inference with Double Machine Learning (DML)**

**1. Approach**

  The goal of this project is to estimate how a treatment affects an outcome, both on average and for different individuals.

**To do this, I created a synthetic dataset and applied two methods:**
  A simple baseline model called Ordinary Least Squares (OLS)
  A more advanced method called Double Machine Learning (DML)
DML is specifically designed to work well when the data has many variables and complex nonlinear relationships.

**2. Methodology**

**2.1 Dataset Generation**
I created a synthetic dataset containing:
  5000 samples
  60 covariates (x0 to x59)
  A treatment variable (T)
  An outcome variable (Y)
The relationships between the variables were intentionally made complex and nonlinear. This ensures the dataset reflects real-world situations where confounding is strong.

**The dataset also includes:**
  The true treatment effect for each individual
  The predicted treatment effect generated by the DML model

**2.2 Baseline Method: Ordinary Least Squares (OLS)**
  OLS was used as a simple benchmark method.
However, OLS struggles in this project because:
  The data has many variables
  The relationships are nonlinear
  Confounding is strong
As expected, the OLS results were biased.

**2.3 Double Machine Learning (DML)**
The DML approach works in several steps:
  Split the data into multiple folds
  Use machine learning models to estimate outcome predictions
  Use another model to estimate treatment probabilities
  Remove the confounding effect using residuals
  Re-estimate the treatment effect with the cleaned data
  Use another model to estimate individual-level treatment effects (CATE)
This method reduces bias and gives a more reliable estimate compared to OLS.

**3. Findings**
**3.1 Average Treatment Effect (ATE)**
The results were:
  True ATE: 0.7896
  OLS ATE: 1.0765 (overestimates the effect)
  DML ATE: 0.7260 (closest to the true value)

**Interpretation:**
  DML produced a more accurate estimate.
  OLS was biased due to its inability to handle nonlinear interactions.

**3.2 Conditional Average Treatment Effect (CATE)**
  CATE represents how the treatment effect varies for different individuals.
The comparison between true and predicted CATE values produced:
  **CATE MSE (Error): 4.3913**
Although the CATE predictions are noisy, they still show a clear pattern and capture the main structure of how the treatment effect varies across individuals.

**3.3 Visualizations**
**1. Histogram — True vs Predicted CATE**
  Shows the distribution of true and predicted effects.
  The predicted values are wider, showing some variance, which is normal.

**2. Scatter Plot — True vs Predicted CATE**
  Shows the relationship between true and predicted values for 1000 samples.
  There is a general trend, with some noise, which is expected for high-variance CATE models.
  
**4. Ten Sample CATE Values**
  Below are 10 diverse examples comparing true and predicted CATE values from the dataset:

idx=1501  true=+0.8292  predicted=+2.0075
idx=2586  true=+1.4270  predicted=+7.2361
idx=2653  true=+0.7606  predicted=+7.2158
idx=1055  true=+3.2716  predicted=+3.0196
idx=705   true=+0.6588  predicted=-1.1027
idx=106   true=+1.5471  predicted=+0.8325
idx=589   true=-1.1237  predicted=+0.8850
idx=2468  true=-0.3142  predicted=+3.9189
idx=2413  true=-0.4442  predicted=-0.0686
idx=1600  true=+2.2787  predicted=+1.2380

**5. Conclusion**
  This project demonstrates the advantages of Double Machine Learning in high-dimensional, nonlinear settings.
Compared to OLS, DML provided:
  A more accurate estimate of the overall treatment effect
  A deeper understanding of how the treatment effect varies across individuals
  Better handling of confounding and noise
While the CATE predictions show some variability, they still reveal meaningful patterns of heterogeneous treatment effects.
Overall, DML proved to be a more robust and reliable method for causal inference in complex datasets.
